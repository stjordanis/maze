<!DOCTYPE html>
<html lang="en">
<head>
  <title>Comments on Vim Sudo Write Trick - Susam's Maze</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#333">
  <link rel="canonical" href="https://susam.in/maze/comments/vim-sudo-write-trick.html">
  <link rel="icon" type="image/png" href="../favicon.png">
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/comment.css">
</head>
<body>
<main class="comments">
<h1>
Comments on
<a href="../vim-sudo-write-trick.html">Vim Sudo Write Trick</a>
</h1>

<div><a href="https://susam.in/maze/../app/comment/?post=vim-sudo-write-trick">Post Comment</a></div>

<section id="1" class="comment visitor">
<h2>LP said:</h2>
<p>
  The quotes around the percent sign are unnecessary. The
    command <code>:w ! sudo tee %</code> works just fine. I use it
    everytime!
</p>

<div>
<a href="#1">30 Oct 2021 20:06 GMT</a>
  (<a href="#1">#1 of 2 comments</a>)
</div>
</section>
<section id="2" class="comment author">
<h2><a href="https://susam.in/">Susam Pal</a> said:</h2>
<p>
  LP,
</p>
<p>
  Like I explained in my blog post, the quotes around the percent sign
  are necessary to keep the filename as a single argument when the
  filename contains whitespace. If there is no whitespace in the
  filename, then the quotes are not necessary.
</p>
<p>
  Here is an experiment that demonstrates the purpose of quotes:
</p>
<ol>
  <li>
    <p>
      Enter the following command to create a filename with a space in
      it and then open it with Vim:
    </p>
    <pre><code>sudo touch "foo bar.txt"
vim "foo bar.txt"</code></pre>
  </li>
  <li>
    <p>
      In Vim, insert some text with the following key sequence:
      <kbd>i</kbd> <kbd>hello</kbd> <kbd>&lt;esc&gt;</kbd>.
    </p>
  </li>
  <li>
    <p>
      Now enter the following command in Vim to save the file:
    </p>
    <pre><code>:w !sudo tee %</code></pre>
  </li>
  <li>
    <p>
      In another instance of the terminal, enter the following command
      to check the content of the file:
    </p>
    <pre><code>cat "foo bar.txt"</code></pre>
    <p>
      The file still appears empty. Nothing was saved to this file.
    </p>
  </li>
  <li>
    <p>
      Now enter the following commands:
    </p>
    <pre><code>cat foo
cat bar.txt</code></pre>
    <p>
      Both files contain the text <code>hello</code> in them.
    </p>
  </li>
</ol>
<p>
  This experiment shows that due to the lack of quotes
  around <code>%</code>, the command <code>tee %</code> expands
  to <code>tee foo bar.txt</code> which ends up writing the content of
  the buffer to both files <code>foo</code> and <code>bar.txt</code>
  but not to <code>foo bar.txt</code> as we desire.
</p>
<p>
  This is why we need to write <code>tee "%"</code> so that it expands
  to <code>tee "foo bar.txt"</code> and the content of the buffer is
  written to the file named <code>foo bar.txt</code>.
</p>

<div>
<a href="#2">01 Nov 2021 16:00 GMT</a>
  (<a href="#2">#2 of 2 comments</a>)
</div>
</section>


<div><a href="https://susam.in/maze/../app/comment/?post=vim-sudo-write-trick">Post Comment</a></div>
</main>

<footer class="textcenter">
  <hr>
  <div>
    <a href=".././">Maze</a>
    <a href=".././tags.html">Tags</a>
    <a href=".././rss.xml">Feed</a>
    <a href="https://susam.in/maze/../app/subscribe/">Subscribe</a>
    <a href="../about.html">About</a>
    <a href="/">Home</a>
    <a href="https://github.com/susam">GitHub</a>
    <a href="https://twitter.com/susam">Twitter</a>
  </div>
  <p>&copy; 2001&ndash;2021 Susam Pal</p>
</footer>
</body>
</html>
